<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <title>AR Marker Recognition</title>
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .ar-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        .instructions {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
        }
        
        .back-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1001;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            -webkit-tap-highlight-color: transparent;
        }
        
        .back-button:hover,
        .back-button:active {
            background: #0056b3;
            transform: scale(0.95);
        }
        
        .camera-selector {
            position: absolute;
            top: 80px;
            left: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 1000;
            display: none;
        }
        
        .camera-selector select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: none;
            background: white;
            color: black;
            margin-top: 10px;
        }
        
        .camera-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1001;
            font-size: 16px;
            font-weight: 500;
            min-height: 44px;
            min-width: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            -webkit-tap-highlight-color: transparent;
        }
        
        .camera-toggle:hover,
        .camera-toggle:active {
            background: #218838;
            transform: scale(0.95);
        }

        /* „É¢„Éê„Ç§„É´ÂØæÂøú„ÅÆ„É°„Éá„Ç£„Ç¢„ÇØ„Ç®„É™ */
        @media (max-width: 768px) {
            .back-button {
                top: 15px;
                right: 15px;
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .camera-toggle {
                top: 15px;
                left: 15px;
                padding: 10px 14px;
                font-size: 14px;
            }
            
            .instructions {
                top: 15px;
                left: 15px;
                right: 15px;
                padding: 12px;
                font-size: 14px;
            }
            
            .camera-selector {
                top: 70px;
                left: 15px;
                right: 15px;
                padding: 12px;
            }
            
            .camera-selector select {
                font-size: 16px; /* iOS„Åß„ÅÆ„Ç∫„Éº„É†Èò≤Ê≠¢ */
                padding: 12px 8px;
            }
            
            .camera-selector button {
                padding: 12px;
                font-size: 16px;
                min-height: 44px;
            }
        }

        /* Á∏¶ÁîªÈù¢„É¢„Éê„Ç§„É´Áî® */
        @media (max-width: 480px) and (orientation: portrait) {
            .back-button {
                top: 10px;
                right: 10px;
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .camera-toggle {
                top: 10px;
                left: 10px;
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .instructions {
                top: 10px;
                left: 10px;
                right: 10px;
                padding: 10px;
                font-size: 12px;
            }
            
            .camera-selector {
                top: 60px;
                left: 10px;
                right: 10px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="ar-container">
        <a href="/" class="back-button">‚Üê Êàª„Çã</a>
        <button class="camera-toggle" onclick="toggleCameraSelector()">üì∑ „Ç´„É°„É©ÈÅ∏Êäû</button>
        
        <div class="camera-selector" id="cameraSelector">
            <h4>„Ç´„É°„É©„Éá„Éê„Ç§„Çπ„ÇíÈÅ∏Êäû</h4>
            <p style="font-size: 12px; margin: 5px 0; color: #ccc;">
                ÂàùÂõû„ÅØ„Ç´„É°„É©„ÅÆË®±ÂèØ„ÅåÂøÖË¶Å„Åß„Åô„ÄÇË©≥Á¥∞„Å™„Éá„Éê„Ç§„ÇπÂêç„ÇíË°®Á§∫„Åô„Çã„Åü„ÇÅ„Å´„ÄÅ„Ç´„É°„É©„Ç¢„ÇØ„Çª„Çπ„ÇíË®±ÂèØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
            </p>
            <select id="cameraSelect">
                <option value="">„Ç´„É°„É©„ÇíÊ§úÁ¥¢‰∏≠...</option>
            </select>
            <button onclick="applyCameraSelection()" style="
                width: 100%;
                padding: 10px;
                margin-top: 10px;
                background: #007bff;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            ">„Ç´„É°„É©„ÇíÈÅ©Áî®</button>
            <div id="cameraDebugInfo" style="
                font-size: 10px;
                color: #ccc;
                margin-top: 5px;
                padding: 5px;
                background: rgba(0,0,0,0.3);
                border-radius: 3px;
                display: none;
            "></div>
            <button onclick="refreshCameraList()" style="
                width: 100%;
                padding: 8px;
                margin-top: 5px;
                background: #6c757d;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 12px;
            ">„Ç´„É°„É©‰∏ÄË¶ß„ÇíÊõ¥Êñ∞</button>
        </div>

        <!-- A-Frame AR Scene -->
        <a-scene
            vr-mode-ui="enabled: false;"
            renderer="logarithmicDepthBuffer: true; colorManagement: true;"
            embedded
            arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3; sourceWidth: 1280; sourceHeight: 720; displayWidth: 1280; displayHeight: 720;"
            id="arScene">
            
            <!-- „Ç´„Çπ„Çø„É†„Éû„Éº„Ç´„ÉºÁî®„ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà -->
            <a-marker id="custom-marker" type="pattern" url="./markers/pattern.patt">
                <!-- 3D„É¢„Éá„É´ -->
                <a-gltf-model src="./models/scene.gltf" scale="0.0025 0.0025 0.0025" position="0 0.5 0"></a-gltf-model>
                
                <!-- „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÁî®„ÅÆÂü∫Êú¨ÂΩ¢Áä∂ -->
                <a-box position="0 0.5 0" material="color: red;" rotation="0 45 0" visible="false"></a-box>
                <a-sphere position="1 1 0" material="color: blue;" radius="0.3" visible="false"></a-sphere>
                <a-cylinder position="-1 1 0" material="color: green;" radius="0.3" height="1" visible="false"></a-cylinder>
                <a-cone position="0 2 0" material="color: yellow;" radius-bottom="0.5" height="1" visible="false"></a-cone>
            </a-marker>

            <!-- „Ç´„É°„É©Ë®≠ÂÆö -->
            <a-entity camera></a-entity>
        </a-scene>
    </div>

    <script>
        let availableCameras = [];
        let currentCameraId = null;

        // „É¢„Éê„Ç§„É´„Éá„Éê„Ç§„Çπ„Åã„Å©„ÅÜ„Åã„ÇíÂà§ÂÆö
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   (window.innerWidth <= 768);
        }

        // „Ç´„É°„É©„Éá„Éê„Ç§„Çπ„ÇíÂèñÂæó„Åô„ÇãÈñ¢Êï∞
        async function getCameraDevices() {
            try {
                // „É¢„Éê„Ç§„É´Áî®„ÅÆ„Ç´„É°„É©Ë®≠ÂÆö
                const constraints = {
                    video: {
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: isMobile() ? { ideal: 'environment' } : 'user' // „É¢„Éê„Ç§„É´„Åß„ÅØËÉåÈù¢„Ç´„É°„É©„ÇíÂÑ™ÂÖà
                    }
                };
                
                // „Åæ„Åö‰∏ÄÊôÇÁöÑ„Å´„Ç´„É°„É©„Ç¢„ÇØ„Çª„Çπ„ÇíÂèñÂæó„Åó„Å¶„Éá„Éê„Ç§„ÇπÂêç„ÇíÂèñÂæó
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                
                // „Ç´„É°„É©„ÅÆË©≥Á¥∞ÊÉÖÂ†±„ÇíÂèñÂæó
                const devices = await navigator.mediaDevices.enumerateDevices();
                const videoDevices = devices.filter(device => device.kind === 'videoinput');
                availableCameras = videoDevices;
                
                // ‰∏ÄÊôÇÁöÑ„Å™„Çπ„Éà„É™„Éº„É†„ÇíÂÅúÊ≠¢
                stream.getTracks().forEach(track => track.stop());
                
                const select = document.getElementById('cameraSelect');
                select.innerHTML = '';
                
                if (videoDevices.length === 0) {
                    select.innerHTML = '<option value="">„Ç´„É°„É©„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</option>';
                    return;
                }
                
                videoDevices.forEach((device, index) => {
                    const option = document.createElement('option');
                    option.value = device.deviceId;
                    
                    // „Éá„Éê„Ç§„ÇπÂêç„Çí„Çà„ÇäË©≥Á¥∞„Å´Ë°®Á§∫
                    let deviceName = device.label;
                    if (!deviceName || deviceName === '') {
                        // „Éá„Éê„Ç§„ÇπÂêç„ÅåÂèñÂæó„Åß„Åç„Å™„ÅÑÂ†¥Âêà„ÄÅ„Çà„ÇäË©≥Á¥∞„Å™ÊÉÖÂ†±„ÇíË°®Á§∫
                        deviceName = `„Ç´„É°„É© ${index + 1} (ID: ${device.deviceId.substring(0, 8)}...)`;
                    }
                    
                    option.textContent = deviceName;
                    select.appendChild(option);
                });
                
                // „Éá„Éï„Ç©„É´„Éà„ÅßÊúÄÂàù„ÅÆ„Ç´„É°„É©„ÇíÈÅ∏Êäû
                if (videoDevices.length > 0) {
                    select.value = videoDevices[0].deviceId;
                    currentCameraId = videoDevices[0].deviceId;
                }
                
            } catch (error) {
                console.error('„Ç´„É°„É©„Éá„Éê„Ç§„Çπ„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', error);
                
                // „Ç´„É°„É©„Ç¢„ÇØ„Çª„Çπ„ÅåÊãíÂê¶„Åï„Çå„ÅüÂ†¥Âêà„ÄÅÂü∫Êú¨ÁöÑ„Å™ÊÉÖÂ†±„ÅÆ„ÅøË°®Á§∫
                try {
                    const devices = await navigator.mediaDevices.enumerateDevices();
                    const videoDevices = devices.filter(device => device.kind === 'videoinput');
                    
                    const select = document.getElementById('cameraSelect');
                    select.innerHTML = '';
                    
                    if (videoDevices.length === 0) {
                        select.innerHTML = '<option value="">„Ç´„É°„É©„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</option>';
                        return;
                    }
                    
                    videoDevices.forEach((device, index) => {
                        const option = document.createElement('option');
                        option.value = device.deviceId;
                        option.textContent = `„Ç´„É°„É© ${index + 1} (Ë©≥Á¥∞ÊÉÖÂ†±„ÅØ„Ç´„É°„É©Ë®±ÂèØÂæå„Å´Ë°®Á§∫)`;
                        select.appendChild(option);
                    });
                    
                    if (videoDevices.length > 0) {
                        select.value = videoDevices[0].deviceId;
                        currentCameraId = videoDevices[0].deviceId;
                    }
                    
                } catch (fallbackError) {
                    console.error('„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂá¶ÁêÜ„ÇÇÂ§±Êïó„Åó„Åæ„Åó„Åü:', fallbackError);
                    document.getElementById('cameraSelect').innerHTML = '<option value="">„Ç´„É°„É©„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</option>';
                }
            }
        }

        // „Ç´„É°„É©„Çª„É¨„ÇØ„Çø„Éº„ÅÆË°®Á§∫/ÈùûË°®Á§∫„ÇíÂàá„ÇäÊõø„Åà
        function toggleCameraSelector() {
            const selector = document.getElementById('cameraSelector');
            const debugInfo = document.getElementById('cameraDebugInfo');
            
            if (selector.style.display === 'none' || selector.style.display === '') {
                selector.style.display = 'block';
                debugInfo.style.display = 'block';
                
                // „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±„ÇíÊõ¥Êñ∞
                updateDebugInfo();
                
                if (availableCameras.length === 0) {
                    getCameraDevices();
                }
            } else {
                selector.style.display = 'none';
                debugInfo.style.display = 'none';
            }
        }

        // „Ç´„É°„É©‰∏ÄË¶ß„ÇíÊõ¥Êñ∞„Åô„ÇãÈñ¢Êï∞
        async function refreshCameraList() {
            const select = document.getElementById('cameraSelect');
            select.innerHTML = '<option value="">„Ç´„É°„É©„ÇíÂÜçÊ§úÁ¥¢‰∏≠...</option>';
            
            // Âà©Áî®ÂèØËÉΩ„Å™„Ç´„É°„É©„É™„Çπ„Éà„Çí„É™„Çª„ÉÉ„Éà
            availableCameras = [];
            
            // „Ç´„É°„É©„Éá„Éê„Ç§„Çπ„ÇíÂÜçÂèñÂæó
            await getCameraDevices();
        }

        // ÈÅ∏Êäû„Åï„Çå„Åü„Ç´„É°„É©„ÇíÈÅ©Áî®
        async function applyCameraSelection() {
            const selectedCameraId = document.getElementById('cameraSelect').value;
            if (!selectedCameraId) {
                alert('„Ç´„É°„É©„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            if (selectedCameraId === currentCameraId) {
                alert('Âêå„Åò„Ç´„É°„É©„ÅåÊó¢„Å´ÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åô');
                return;
            }
            
            try {
                // ÈÅ∏Êäû„Åï„Çå„Åü„Ç´„É°„É©„Åß„Çπ„Éà„É™„Éº„É†„ÇíÂèñÂæóÔºà„É¢„Éê„Ç§„É´ÂØæÂøúÔºâ
                const constraints = {
                    video: {
                        deviceId: { exact: selectedCameraId },
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: isMobile() ? { ideal: 'environment' } : undefined
                    }
                };
                
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                
                // AR.js„ÅÆ„Ç´„É°„É©„ÇΩ„Éº„Çπ„ÇíÊõ¥Êñ∞
                const scene = document.querySelector('a-scene');
                const arjs = scene.components.arjs;
                
                if (arjs && arjs.data && arjs.data.sourceType === 'webcam') {
                    // Êó¢Â≠ò„ÅÆ„Éì„Éá„Ç™„Çπ„Éà„É™„Éº„É†„ÇíÂÅúÊ≠¢
                    if (arjs.videoElement && arjs.videoElement.srcObject) {
                        const oldStream = arjs.videoElement.srcObject;
                        oldStream.getTracks().forEach(track => track.stop());
                    }
                    
                    // Êñ∞„Åó„ÅÑ„Çπ„Éà„É™„Éº„É†„ÇíË®≠ÂÆö
                    arjs.videoElement.srcObject = stream;
                    
                    // AR.js„ÇíÂÜçÂàùÊúüÂåñ
                    arjs.play();
                }
                
                currentCameraId = selectedCameraId;
                
                // „Çª„É¨„ÇØ„Çø„Éº„ÇíÈùûË°®Á§∫„Å´„Åô„Çã
                document.getElementById('cameraSelector').style.display = 'none';
                
                console.log('„Ç´„É°„É©„ÅåÂ§âÊõ¥„Åï„Çå„Åæ„Åó„Åü:', selectedCameraId);
                
            } catch (error) {
                console.error('„Ç´„É°„É©„ÅÆÂàá„ÇäÊõø„Åà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:', error);
                alert('„Ç´„É°„É©„ÅÆÂàá„ÇäÊõø„Åà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message);
            }
        }

        // „Éû„Éº„Ç´„Éº„ÅåË™çË≠ò„Åï„Çå„ÅüÊôÇ„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.addEventListener('DOMContentLoaded', function() {
            const scene = document.querySelector('a-scene');
            
            // „É¢„Éê„Ç§„É´Áî®„ÅÆÂàùÊúüË®≠ÂÆö
            if (isMobile()) {
                console.log('„É¢„Éê„Ç§„É´„Éá„Éê„Ç§„Çπ„ÇíÊ§úÂá∫„Åó„Åæ„Åó„Åü');
                // iOS SafariÁî®„ÅÆË®≠ÂÆö
                if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {
                    document.body.style.webkitTransform = 'translateZ(0)';
                    document.body.style.transform = 'translateZ(0)';
                }
            }
            
            // „Ç´„É°„É©„Éá„Éê„Ç§„Çπ„ÇíÂèñÂæó
            getCameraDevices();
            
            // AR.js„ÅåÂÆåÂÖ®„Å´ÂàùÊúüÂåñ„Åï„Çå„Çã„Åæ„ÅßÂæÖÊ©ü
            scene.addEventListener('loaded', function() {
                console.log('AR.js scene loaded');
                
                // ÂàùÊúü„Ç´„É°„É©ID„ÇíË®≠ÂÆö
                const arjs = scene.components.arjs;
                if (arjs && arjs.videoElement && arjs.videoElement.srcObject) {
                    // ÁèæÂú®„ÅÆ„Çπ„Éà„É™„Éº„É†„Åã„Çâ„Éá„Éê„Ç§„ÇπID„ÇíÂèñÂæó
                    const track = arjs.videoElement.srcObject.getVideoTracks()[0];
                    if (track) {
                        const settings = track.getSettings();
                        currentCameraId = settings.deviceId;
                        console.log('Initial camera ID:', currentCameraId);
                    }
                }
                
                // „Éá„Éê„ÉÉ„Ç∞ÊÉÖÂ†±„ÇíÂÆöÊúüÁöÑ„Å´Êõ¥Êñ∞
                setInterval(updateMainDebugInfo, 1000);
            });
            
            // „Ç´„Çπ„Çø„É†„Éû„Éº„Ç´„Éº„ÅåË™çË≠ò„Åï„Çå„ÅüÊôÇ
            const customMarker = document.querySelector('#custom-marker');
            customMarker.addEventListener('markerFound', function() {
                console.log('Pattern marker found!');
                console.log('Pattern marker object3D visible:', customMarker.object3D.visible);
                
                // 3D„É¢„Éá„É´„Å´„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíËøΩÂä†
                const model = document.querySelector('#custom-marker a-gltf-model');
                if (model) {
                    model.setAttribute('animation', 'property: rotation; to: 0 360 0; dur: 5000; easing: linear');
                    console.log('Pattern GLTF model animation added');
                } else {
                    console.log('Pattern GLTF model not found');
                    
                    // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂΩ¢Áä∂„ÇíË°®Á§∫
                    const box = document.querySelector('#custom-marker a-box');
                    if (box) {
                        box.setAttribute('visible', 'true');
                        box.setAttribute('animation', 'property: rotation; to: 0 405 0; dur: 2000; easing: linear');
                        console.log('Pattern box fallback animation added');
                    }
                }
            });
            
            customMarker.addEventListener('markerLost', function() {
                console.log('Pattern marker lost!');
            });

            // 3D„É¢„Éá„É´„ÅÆË™≠„ÅøËæº„Åø„Ç®„É©„Éº„Çí„Ç≠„É£„ÉÉ„ÉÅ
            const gltfModels = document.querySelectorAll('a-gltf-model');
            gltfModels.forEach((model, index) => {
                model.addEventListener('model-loaded', function() {
                    console.log(`3D„É¢„Éá„É´ ${index + 1} Ë™≠„ÅøËæº„ÅøÂÆå‰∫Ü`);
                });
                
                model.addEventListener('model-error', function(event) {
                    console.error(`3D„É¢„Éá„É´ ${index + 1} Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº:`, event.detail);
                    const modelStatus = document.getElementById('modelStatus');
                    modelStatus.textContent = `3D„É¢„Éá„É´Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº: ${event.detail}`;
                    
                    // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂΩ¢Áä∂„ÇíË°®Á§∫
                    const marker = model.closest('a-marker');
                    const fallbacks = marker.querySelectorAll('[visible="false"]');
                    fallbacks.forEach(fallback => {
                        fallback.setAttribute('visible', 'true');
                    });
                    console.log('„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂΩ¢Áä∂„ÇíË°®Á§∫„Åó„Åæ„Åó„Åü');
                });
            });

            // 5ÁßíÂæå„Å´3D„É¢„Éá„É´„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ„ÇíË°®Á§∫
            setTimeout(() => {
                gltfModels.forEach((model, index) => {
                    if (model.object3D.children.length === 0) {
                        console.log(`3D„É¢„Éá„É´ ${index + 1} „ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂΩ¢Áä∂„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ`);
                        const marker = model.closest('a-marker');
                        const fallbacks = marker.querySelectorAll('[visible="false"]');
                        fallbacks.forEach(fallback => {
                            fallback.setAttribute('visible', 'true');
                        });
                    }
                });
            }, 5000);
        });
    </script>
</body>
</html>
